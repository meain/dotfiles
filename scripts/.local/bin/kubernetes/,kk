#!/bin/sh

# Fuzzy select a kubernetes resource and run a kubectl command on it
# Example usage: ,kk log --tail 10 -f (this will let you pick a resource and log it)
#
# We could probably filter the resources only down tot he ones that
# support the command, but this is good enough for now

set -e

line="$(kubectl get all --no-headers --all-namespaces | fzf)"

namespace="$(echo "$line" | awk '{print $1}')"
resource="$(echo "$line" | awk '{print $2}')"

echo kubectl "$@" -n "$namespace" "$resource" >&2
kubectl "$@" -n "$namespace" "$resource"
